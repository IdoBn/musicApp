"use strict";angular.module("com.2fdevs.videogular.plugins.controls",[]).directive("vgControls",["$timeout","VG_STATES","VG_EVENTS",function(a,b,c){return{restrict:"E",require:"^videogular",transclude:!0,template:'<div id="controls-container" ng-show="isReady" ng-class="animationClass" ng-transclude></div>',scope:{autoHide:"=vgAutohide",autoHideTime:"=vgAutohideTime"},link:function(b,d,e,f){function g(a,b){o=b[0],p=b[1],d.css("top",parseInt(p,10)-parseInt(r,10)+"px")}function h(){j(),b.$apply()}function i(){b.animationClass="hide-animation"}function j(){b.animationClass="show-animation",a.cancel(m),b.autoHide&&(m=a(i,q))}function k(){var b=f.getSize();d.css("top",parseInt(b.height,10)-parseInt(r,10)+"px"),n=a(l,500)}function l(){a.cancel(n),b.isReady=!0}var m,n,o=0,p=0,q=2e3,r=d[0].style.height;b.isReady=!1,void 0!=b.autoHide&&b.$watch("autoHide",function(c){c?(b.animationClass="hide-animation",f.videogularElement.bind("mousemove",h)):(b.animationClass="",a.cancel(m),f.videogularElement.unbind("mousemove",h),j())}),void 0!=b.autoHideTime&&b.$watch("autoHideTime",function(a){q=a}),f.$on(c.ON_UPDATE_SIZE,g),f.isPlayerReady()?k():f.$on(c.ON_PLAYER_READY,k)}}}]).directive("vgPlayPauseButton",["VG_STATES","VG_EVENTS",function(a,b){return{restrict:"E",require:"^videogular",template:"<div class='iconButton' ng-class='playPauseIcon'></div>",link:function(c,d,e,f){function g(b,d){switch(d[0]){case a.PLAY:c.playPauseIcon={pause:!0};break;case a.PAUSE:c.playPauseIcon={play:!0};break;case a.STOP:c.playPauseIcon={play:!0}}c.$apply()}function h(){f.playPause()}c.playPauseIcon={play:!0},d.bind("click",h),f.$on(b.ON_SET_STATE,g)}}}]).directive("vgTimedisplay",["VG_EVENTS",function(a){return{require:"^videogular",restrict:"E",link:function(b,c,d,e){function f(a){var b=Math.floor(a/60),c=Math.floor(a-60*b),d=10>b?"0"+b:b,e=10>c?"0"+c:c;return{mins:d,secs:e}}function g(a,c){var d=f(c[0]);b.currentTime=d.mins+":"+d.secs}function h(){b.currentTime="00:00"}function i(a,c){var d=f(c[0]);b.totalTime=d.mins+":"+d.secs}b.currentTime="00:00",b.totalTime="00:00",e.$on(a.ON_START_PLAYING,i),e.$on(a.ON_UPDATE_TIME,g),e.$on(a.ON_COMPLETE,h)}}}]).directive("vgScrubbar",["VG_EVENTS","VG_STATES","VG_UTILS",function(a,b,c){return{restrict:"AE",require:"^videogular",replace:!0,link:function(d,e,f,g){function h(a){var b,d=a.originalEvent.touches;u=c.isiOSDevice()?-1*(d[0].clientX-a.originalEvent.layerX):a.originalEvent.layerX,b=d[0].clientX+u-d[0].target.offsetLeft,r=!0,s&&(t=!0),p(b*g.videoElement[0].duration/e[0].scrollWidth),g.pause()}function i(){t&&(t=!1,g.play()),r=!1}function j(a){var b,c=a.originalEvent.touches;r&&(b=c[0].clientX+u-c[0].target.offsetLeft,p(b*g.videoElement[0].duration/e[0].scrollWidth))}function k(){r=!1}function l(a){a=c.fixEventOffset(a),r=!0,s&&(t=!0),p(a.offsetX*g.videoElement[0].duration/e[0].scrollWidth),g.pause()}function m(a){a=c.fixEventOffset(a),t&&(t=!1,g.play()),r=!1,p(a.offsetX*g.videoElement[0].duration/e[0].scrollWidth)}function n(a){r&&(a=c.fixEventOffset(a),p(a.offsetX*g.videoElement[0].duration/e[0].scrollWidth))}function o(){r=!1}function p(a){g.seekTime(a)}function q(a,c){if(!r)switch(c[0]){case b.PLAY:s=!0;break;case b.PAUSE:s=!1;break;case b.STOP:s=!1}}var r=!1,s=!1,t=!1,u=0;g.$on(a.ON_SET_STATE,q),c.isMobileDevice()?(e.bind("touchstart",h),e.bind("touchend",i),e.bind("touchmove",j),e.bind("touchleave",k)):(e.bind("mousedown",l),e.bind("mouseup",m),e.bind("mousemove",n),e.bind("mouseleave",o))}}}]).directive("vgScrubbarcurrenttime",["VG_EVENTS",function(a){return{restrict:"E",require:"^videogular",link:function(b,c,d,e){function f(a,b){h=Math.round(b[0]/b[1]*100),c.css("width",h+"%")}function g(){h=0,c.css("width",h+"%")}var h=0;e.$on(a.ON_UPDATE_TIME,f),e.$on(a.ON_COMPLETE,g)}}}]).directive("vgVolume",["VG_UTILS",function(a){return{restrict:"E",link:function(b,c){function d(){b.volumeVisibility="visible",b.$apply()}function e(){b.volumeVisibility="hidden",b.$apply()}a.isMobileDevice()?c.css("display","none"):(b.volumeVisibility="hidden",c.bind("mouseover",d),c.bind("mouseleave",e))}}}]).directive("vgVolumebar",["VG_EVENTS","VG_UTILS",function(a,b){return{restrict:"E",require:"^videogular",template:"<div class='verticalVolumeBar'><div class='volumeBackground'><div class='volumeValue'></div><div class='volumeClickArea'></div></div></div>",link:function(c,d,e,f){function g(a){a=b.fixEventOffset(a);var c=parseInt(p.prop("offsetHeight")),d=100*a.offsetY/c,e=1-d/100;l(d),f.setVolume(e)}function h(){o=!0}function i(){o=!1}function j(){o=!1}function k(a){if(o){a=b.fixEventOffset(a);var c=parseInt(p.prop("offsetHeight")),d=100*a.offsetY/c,e=1-d/100;l(d),f.setVolume(e)}}function l(a){q.css("height",a+"%"),q.css("top",100-a+"%")}function m(a,b){l(100*b[0])}function n(a){d.css("visibility",a)}var o=!1,p=angular.element(d[0].getElementsByClassName("volumeBackground")),q=angular.element(d[0].getElementsByClassName("volumeValue"));d.css("visibility",c.volumeVisibility),c.$watch("volumeVisibility",n),p.bind("click",g),p.bind("mousedown",h),p.bind("mouseup",i),p.bind("mousemove",k),p.bind("mouseleave",j),f.$on(a.ON_SET_VOLUME,m)}}}]).directive("vgMutebutton",["VG_EVENTS",function(a){return{restrict:"E",require:"^videogular",template:"<div class='iconButton' ng-class='muteIcon'></div>",link:function(b,c,d,e){function f(){h?b.currentVolume=b.defaultVolume:(b.currentVolume=0,b.muteIcon={mute:!0}),h=!h,e.setVolume(b.currentVolume)}function g(a,c){b.currentVolume=c[0],h?c[0]>0&&(b.defaultVolume=c[0]):b.defaultVolume=c[0];var d=Math.round(100*c[0]);0==d?b.muteIcon={mute:!0}:d>0&&25>d?b.muteIcon={level0:!0}:d>=25&&50>d?b.muteIcon={level1:!0}:d>=50&&75>d?b.muteIcon={level2:!0}:d>=75&&(b.muteIcon={level3:!0}),b.$apply()}var h=!1;b.defaultVolume=1,b.currentVolume=b.defaultVolume,b.muteIcon={level3:!0},c.bind("click",f),e.$on(a.ON_SET_VOLUME,g)}}}]).directive("vgFullscreenbutton",["$window","VG_EVENTS",function(a,b){return{restrict:"AE",require:"^videogular",scope:{vgEnterFullScreenIcon:"=",vgExitFullScreenIcon:"="},template:"<div class='iconButton' ng-class='fullscreenIcon'></div>",link:function(a,c,d,e){function f(){a.fullscreenIcon={exit:!0}}function g(){a.fullscreenIcon={enter:!0}}function h(){e.toggleFullScreen()}c.bind("click",h),a.fullscreenIcon={enter:!0},e.$on(b.ON_ENTER_FULLSCREEN,f),e.$on(b.ON_EXIT_FULLSCREEN,g)}}}]);